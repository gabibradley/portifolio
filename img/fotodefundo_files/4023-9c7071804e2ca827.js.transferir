"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4023],{54023:function(n,e,t){t.d(e,{Z:function(){return tn}});var o=t(47568),r=t(26042),a=t(69396),i=t(7297),c=t(29815),s=t(20414),l=t(85893),u=t(67294),d=t(5152),p=t.n(d),h=t(27603),m=t(67407),f=t(17269),g=t(22279),v=t(29689),y=t(25675),x=t.n(y),b=t(83916),w=t(29494),k=t(4111),j=t(51438),S=t(52951),Z=t(14924),C=t(88029),A=t(60460),_=t(81923),T=t.n(_),D=t(54655),B=t(83454),E=function(n){(0,C.Z)(t,n);var e=(0,A.Z)(t);function t(n,r){var a;return(0,j.Z)(this,t),a=e.call(this),(0,Z.Z)((0,k.Z)(a),"name","GIPHY"),(0,Z.Z)((0,k.Z)(a),"icon",'<?xml version="1.0" encoding="UTF-8"?> <svg aria-hidden="true" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path fill="#000" d="M54 29h149v198H54z"></path><path fill="#04FF8E" d="M24 22h30v212H24z"></path><path fill="#8E2EFF" d="M203 80h30v154h-30z"></path><path fill="#00C5FF" d="M24 227h209v29H24z"></path><path fill="#FFF152" d="M24 0h119v29H24z"></path><path fill="#FF5B5B" d="M203 59V29h-30V0h-30v88h90V59"></path><path fill="#551C99" d="M203 117V88h30"></path><path fill="#999131" d="M143 0v29h-29"></path></g></svg>'),(0,Z.Z)((0,k.Z)(a),"color","#34495e"),(0,Z.Z)((0,k.Z)(a),"template",(function(n){return'\n      <div class="search-container">\n        <h2 class="black">\n            <img \n              src="https://cdn.hackernoon.com/images/PoweredBy_200_Horizontal_Light-Backgrounds_With_Logo.gif"\n              width="200px"\n              height="42px"\n              alt="Powered by Giphy"\n            />\n        </h2>\n        <form class="search-search-form">\n          <input\n            class="search-search-input"\n            placeholder="search"\n          />\n          <button type="submit">Submit</button>\n        </form>\n\n        <div class="image-grid"></div>\n\n      </div>\n      <div class="uppload-loader search-loader">\n        <div></div>\n        <p>\n          This ought to be good...\n        </p>\n      </div>\n    '})),(0,Z.Z)((0,k.Z)(a),"handlers",(function(n){var e=n.uppload.container.querySelector(".search-search-form");if(e&&(0,D.safeListen)(e,"submit",(function(e){a.loading=!0;var t=n.uppload.container.querySelector(".search-loader"),o=n.uppload.container.querySelector(".search-container");o&&(o.style.display=a.loading?"none":""),t&&(t.style.display=a.loading?"flex":"none");var r=n.uppload.container.querySelector(".search-search-input"),i=n.uppload.container.querySelector("#model");if(i&&i.value,r){var c=r.value,s="development"===B.env.REACT_APP_ENV?"dev":"app";T().auth().currentUser.getIdToken().then((function(e){fetch("https://us-central1-hackernoon-".concat(s,".cloudfunctions.net/generateImage?query=").concat(c),{mode:"cors",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then((function(n){return a.loading=!1,n.json()})).then((function(e){e.message&&n.handle(new Error(e.message)),a.results=e,a.update(n)})).catch((function(e){n.handle(new Error(e.message))}))}))}return e.preventDefault(),!1})),a.results){var t=a.results,r=n.uppload.container.querySelector(".image-grid");r&&t&&(r.innerHTML=t.map((function(n){return a.getResult(n)})).join("\n")),n.uppload.container.querySelectorAll(".result").forEach((function(e,t){var r=(0,k.Z)(a);(0,D.safeListen)(e,"click",(0,o.Z)((function(){var e;return(0,s.__generator)(this,(function(o){switch(o.label){case 0:return e=r.results[t],[4,r.upload(e,n)];case 1:return o.sent(),[2]}}))})))}))}})),a.state=r,a}return(0,S.Z)(t,[{key:"update",value:function(n){n&&this.handlers(n);var e=n.uppload.container.querySelector(".search-loader"),t=n.uppload.container.querySelector(".search-container");t&&(t.style.display=this.loading?"none":""),e&&(e.style.display=this.loading?"flex":"none")}},{key:"getResult",value:function(n){return'\n      <div class="result">\n        <img class="small" src='.concat("".concat(n.replace("giphy.gif/",""),"/200w.gif?cid=5fb67740mfsjwy6qntexswcow4x61kszyngwi4hmoxpd11t5&rid=200w.gif&ct=g"),"></img>\n      </div>")}},{key:"upload",value:function(n,e){var t=this;return(0,o.Z)((function(){var o;return(0,s.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(n)];case 1:return[4,r.sent().blob()];case 2:return o=r.sent(),e.next(function(n,e,t){return n.name="".concat(e,"-import-").concat(t.split("https://i.giphy.com/media/")[1].replace("/giphy.gif","")),n.url=t,n}(function(n){return{name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,blob:n,lastModified:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,type:"gif"}}(o),t.name,n)),[2]}}))}))()}}]),t}(D.UpploadService),N=t(83454),U=function(n){(0,C.Z)(t,n);var e=(0,A.Z)(t);function t(n,r){var a;return(0,j.Z)(this,t),a=e.call(this),(0,Z.Z)((0,k.Z)(a),"name","Stable Diffusion"),(0,Z.Z)((0,k.Z)(a),"icon",'<?xml version="1.0" encoding="UTF-8"?><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 359.999999999998181 360"><defs><style>.cls-1{isolation:isolate;}</style></defs><image id="f7b79674-acb8-49c9-a00c-0463402cff89_copy_2" class="cls-1" width="22" height="22" transform="scale(16.363636363636843)" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAABnElEQVQ4jZWVsU7DMBCG79KAEAUVpLRiQKoQggEGto5dgIX3YOEN4AUQL8A7MMHEAoi9GwMMDKCKoRAqaCUWJBojJ3Fyts9NcpJlOfZ999/5koAPAKutFZhbBhBCWAMAhGOw59VACX37GABniCjGj0vsXmN7JCdMg1vmed/vlaHS0j2BiLw/F7EIWka5VxY6g5tszi7lGlhCj8IdVtX8Vg/lnCrU4fvXFjwDU+hxs50BORD33ITHteGUnrce4lnVznVJKTAPenOQHJe+FHr62dfUpIFZ6DR4XIqzeqilWUZpkWmXZ6bvan6aDUlfM6vdTJUueFFQny5UraVyCS9SrgSYNQaqmNZZBZCO04YLqsC4WLc/Qmb7rQNE5hkOSttNWdZ2o+aTCEU32+uM29HJ5N66j8HhhbbeuOyAejc8Uj+UtX0OAgihqzn0Gn32kl1QUDWm8FvvTn7GKzWvCQV6eRac2NXXSyUomH2sNveiXQteBDXf0OShXwPxN8nn/JD4Ga6x0IXgVYNSxZKDs+nil/+TxHCH4GST8/Nr8A8UKP8ypPJJFAAAAABJRU5ErkJggg=="/></svg> '),(0,Z.Z)((0,k.Z)(a),"color","#34495e"),(0,Z.Z)((0,k.Z)(a),"template",(function(n){return'\n      <div class="search-container">\n        <h2>Stable Diffusion</h2>\n        <form class="search-search-form">\n          <input\n            class="search-search-input"\n            placeholder="describe the image here"\n          />\n          <label for="model">Model:</label>\n          <select name="model" id="model">\n            <option value="stable-diffusion_2_1">Stable Diffusion v2.1</option>\n            <option value="stable-diffusion">Stable Diffusion v1.5</option>\n            <option value="midjourney-diffusion">Midjourney Diffusion</option>\n          </select>\n          <button type="submit">Submit</button>\n        </form>\n\n        <div class="search-images"></div>\n\n      </div>\n      <div class="uppload-loader search-loader">\n        <div></div>\n        <p>\n          Generating image...\n        </p>\n      </div>\n    '})),(0,Z.Z)((0,k.Z)(a),"handlers",(function(n){var e=n.uppload.container.querySelector(".search-search-form");if(e&&(0,D.safeListen)(e,"submit",(function(e){a.loading=!0;var t=n.uppload.container.querySelector(".search-loader"),o=n.uppload.container.querySelector(".search-container");o&&(o.style.display=a.loading?"none":""),t&&(t.style.display=a.loading?"flex":"none");var r=n.uppload.container.querySelector(".search-search-input"),i=n.uppload.container.querySelector("#model"),c="hmm";if(i&&(c=i.value),r){var s=r.value,l="development"===N.env.REACT_APP_ENV?"dev":"app";T().auth().currentUser.getIdToken().then((function(e){fetch("https://us-central1-hackernoon-".concat(l,".cloudfunctions.net/generateImage?model=").concat(c,"&prompt=").concat(s),{mode:"cors",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then((function(n){return a.loading=!1,n.json()})).then((function(e){e.message&&n.handle(new Error(e.message)),a.results=[e.imageUrl],a.update(n)})).catch((function(e){n.handle(new Error(e.message))}))}))}return e.preventDefault(),!1})),a.results){var t=a.results,r=n.uppload.container.querySelector(".search-images");r&&t&&(r.innerHTML=t.map((function(n){return a.getResult(n)})).join("\n")),n.uppload.container.querySelectorAll(".result").forEach((function(e,t){var r=(0,k.Z)(a);(0,D.safeListen)(e,"click",(0,o.Z)((function(){var e;return(0,s.__generator)(this,(function(o){return e=r.results[t],r.upload(e,n),[2]}))})))}))}})),a.state=r,a}return(0,S.Z)(t,[{key:"update",value:function(n){n&&this.handlers(n);var e=n.uppload.container.querySelector(".search-loader"),t=n.uppload.container.querySelector(".search-container");t&&(t.style.display=this.loading?"none":""),e&&(e.style.display=this.loading?"flex":"none")}},{key:"getResult",value:function(n){return'\n      <div class="result">\n        <img class="large" src='.concat(n,"></img>\n      </div>")}},{key:"upload",value:function(n,e){var t=this;(0,D.imageUrlToBlob)(n).then((function(o){return e.next(function(n,e,t){return n.name="".concat(e,"-import-").concat(t.split("https://cdn.hackernoon.com/images/")[1]),n.url=t,n}(function(n){return{name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,blob:n,lastModified:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null}}(o),t.name,n))})).catch((function(n){e.handle(n)}))}}]),t}(D.UpploadService),I=t(23806),F=t(60204),O=(t(13674),t(85434));function P(){var n=(0,i.Z)(["\n  justify-self: right;\n  background-color: #3c3c3b;\n  border-radius: 5px;\n  display: block;\n  text-align: center;\n  margin-right: 0.5rem;\n  cursor: pointer;\n  border: 2px solid transparent;\n  color: #fff;\n  @media only screen and (max-width: 500px) {\n    font-size: 14px;\n  }\n  @media only screen and (max-width: 400px) {\n    font-size: 12px;\n  }\n  i {\n    margin-right: 0.5rem;\n    cursor: pointer;\n    border: 2px solid transparent;\n    color: #fff;\n    white-space: nowrap;\n    i {\n      margin-right: 0.5rem;\n    }\n    &:hover {\n      background-color: #4c4c4b;\n    }\n  }\n"]);return P=function(){return n},n}function z(){var n=(0,i.Z)(["\n  background-color: #f6f7f9;\n  padding: 10px;\n  border-radius: 7px;\n  margin-top: 1em;\n  & .replies {\n    display: flex;\n    margin-top: 1em;\n    & img {\n      width: 2em;\n      height: 2em;\n      @media only screen and (max-width: 500px) {\n        font-size: 14px;\n      }\n      @media only screen and (max-width: 400px) {\n        font-size: 10px;\n      }\n    }\n  }\n  & .profile {\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n    align-items: center;\n    & div {\n      display: flex;\n      align-items: center;\n    }\n  }\n\n  @media only screen and (max-width: 770px) {\n    width: 90%;\n  }\n  .date {\n    color: ",';\n    text-align: "right";\n  }\n']);return z=function(){return n},n}function M(){var n=(0,i.Z)(['\n  h4 {\n    display: flex;\n    align-items: center;\n    text-align: center;\n    font-size: 24px;\n    &:before,\n    &:after {\n      content: "";\n      flex: 1;\n      border-bottom: 2px solid ',";\n    }\n    &:before {\n      margin-right: 0.5em;\n    }\n    &:after {\n      margin-left: 0.5em;\n    }\n  }\n"]);return M=function(){return n},n}function R(){var n=(0,i.Z)(["\n  position: absolute;\n  background-color: white;\n  width: 260px;\n  height: fit-content;\n  border: 1px solid #3c3c3b;\n  border-radius: 5px;\n  margin-top: -70px;\n  margin-left: -20px;\n  z-index: 10;\n  .emojis-container {\n    display: flex;\n    flex-wrap: wrap;\n    align-items: center;\n    padding-top: 10px;\n  }\n  img {\n    border: none;\n    margin-left: 10px;\n    color: white;\n    border-radius: 5px;\n    padding: 3px;\n    margin-bottom: 10px;\n    :hover {\n      cursor: pointer;\n      border: 1px solid #3c3c3b;\n    }\n  }\n"]);return R=function(){return n},n}function q(){var n=(0,i.Z)(["\n  width: 20px;\n  height: 20px;\n  position: absolute;\n  bottom: -10px;\n  left: 30px;\n  z-index: -1;\n  background-color: white;\n  border-bottom: 1px solid #3c3c3b;\n  border-right: 1px solid #3c3c3b;\n  transform: rotate(45deg);\n"]);return q=function(){return n},n}function G(){var n=(0,i.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: fit-content;\n  position: absolute;\n  margin-left: 700px;\n  margin-top: ",";\n  i:hover {\n    cursor: pointer;\n    color: gray;\n  }\n\n  @media only screen and (min-width: 200px) {\n    margin-left: 85%;\n  }\n  @media only screen and (min-width: 470px) {\n    margin-left: 90%;\n  }\n  @media only screen and (min-width: 770px) {\n    margin-left: 57%;\n  }\n  @media only screen and (min-width: 1150px) {\n    margin-left: 700px;\n  }\n"]);return G=function(){return n},n}function L(){var n=(0,i.Z)(["\n  position: absolute;\n  z-index: 9;\n  width: 350px;\n  height: fit-content;\n  display: flex;\n  flex-direction: row-reverse;\n  margin-left: 300px;\n  margin-top: -25px;\n  @media only screen and (min-width: 200px) {\n    margin-left: -10%;\n  }\n  @media only screen and (min-width: 500px) {\n    margin-left: 15%;\n  }\n  @media only screen and (min-width: 760px) {\n    margin-left: 0;\n  }\n  @media only screen and (min-width: 1000px) {\n    margin-left: 300px;\n  }\n  .emoji {\n    padding: 5px;\n    background-color: white;\n    border: 1px solid black;\n    border-radius: 5px;\n    margin-left: 5px;\n    display: flex;\n    align-items: center;\n    color: black;\n    font-size: 12px;\n    :hover {\n      cursor: pointer;\n    }\n  }\n"]);return L=function(){return n},n}function J(){var n=(0,i.Z)(["\n  .nice-button {\n    color: #fff;\n    justify-self: flex-end;\n    background-color: #3c3c3b;\n    border-radius: 5px;\n    display: block;\n    text-align: center;\n    width: 100%;\n    padding: 1rem 0.5rem;\n    cursor: pointer;\n    border: 2px solid transparent;\n    i {\n      margin-right: 0.5rem;\n    }\n    &:hover {\n      border: 2px solid ",";\n    }\n  }\n"]);return J=function(){return n},n}var H=p()((function(){return Promise.all([t.e(5453),t.e(7624),t.e(8977),t.e(6410)]).then(t.t.bind(t,75685,23))}),{loadableGenerated:{webpack:function(){return[75685]}},loading:function(){return"loading..."}}),V=h.default.button.withConfig({componentId:"sc-586b8d05-0"})(P()),Q=h.default.div.withConfig({componentId:"sc-586b8d05-1"})(z(),(function(n){return n.theme.almostBlack})),X=h.default.div.withConfig({componentId:"sc-586b8d05-2"})(M(),(function(n){return n.theme.lightGrey})),W=h.default.div.withConfig({componentId:"sc-586b8d05-3"})(R()),K=h.default.div.withConfig({componentId:"sc-586b8d05-4"})(q()),Y=h.default.div.withConfig({componentId:"sc-586b8d05-5"})(G(),(function(n){return n.hasReplies?"-18%":"-7%"})),$=h.default.div.withConfig({componentId:"sc-586b8d05-6"})(L());function nn(n){var e=n.comment,t=n.staticData,i=(0,u.useState)(e),d=i[0],p=i[1],h=(0,u.useState)(!1),y=h[0],k=h[1],j=(0,u.useState)(null),S=j[0],Z=j[1],C=(0,u.useState)(null),A=C[0],_=C[1],T=(0,u.useState)([]),D=T[0],B=T[1],N=(0,u.useState)([]),P=N[0],z=N[1],M=(0,u.useState)([]),R=M[0],q=M[1],G=(0,u.useState)([{id:"savage-joy",url:"savage-joy.png",reactedBy:[]},{id:"fireball",url:"fireball.gif",reactedBy:[]},{id:"amaze",url:"amaze.gif",reactedBy:[]},{id:"thonking",url:"thonking.gif",reactedBy:[]},{id:"parrot",url:"parrot.gif",reactedBy:[]},{id:"lamp",url:"lamp.png",reactedBy:[]}]),L=G[0],J=G[1],X=(0,u.useState)(!1),tn=X[0],on=X[1],rn=(0,u.useState)(!1),an=rn[0],cn=rn[1],sn=(0,u.useState)(d.text),ln=sn[0],un=sn[1],dn=(0,u.useState)(d.text),pn=dn[0],hn=dn[1],mn=new Date(d.time);mn=mn.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).split(RegExp(",(.*)","s"));var fn=(0,u.useContext)(m.St).user,gn=(0,v.Z)(!1).value;function vn(){return vn=(0,o.Z)((function(n){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:return n.preventDefault(),ln&&fn?(d.text=ln,[4,fetch("https://api.hackernoon.com/comments/editComment/",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:d,user:fn,edit:ln})}).then(function(){var n=(0,o.Z)((function(n){return(0,s.__generator)(this,(function(e){return 200===n.status?(cn(!1),hn(ln)):alert("Something went wrong"),[2]}))}));return function(e){return n.apply(this,arguments)}}())]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))})),vn.apply(this,arguments)}function yn(){return yn=(0,o.Z)((function(n,e){var t,o,r,a,i,c,l,u,p;return(0,s.__generator)(this,(function(e){switch(e.label){case 0:return n.preventDefault(),fn.handle||window.confirm("You need a handle to reply! Would you like to choose one?")&&(window.location.href="https://app.hackernoon.com/boot"),d&&S&&S.length>5&&fn?((0,F.logEventAPI)({category:"Comments",action:"Added Comment",label:"".concat(fn.handle," commented on https://hackernoon.com/").concat(d.doc)}),(0,F.logEventAPI)({category:"Comments",action:"Added Reply",label:"".concat(fn.handle," replied to a comment on https://hackernoon.com/").concat(d.doc)}),(0,g.h)("".concat(fn.handle," replied to your comment!"),"https://app.hackernoon.com/writer/comments",d.author.uid),[4,(0,b.default)()]):[3,9];case 1:return t=e.sent(),(o=t.auth().currentUser)?[4,o.getIdToken()]:[2];case 2:r=e.sent(),a={"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},i="https://us-central1-hackernoon-app.cloudfunctions.net/email/send-comment-email",e.label=3;case 3:return e.trys.push([3,6,,7]),[4,fetch(i,{method:"POST",headers:a,body:JSON.stringify({owner:null===d||void 0===d||null===(c=d.author)||void 0===c?void 0:c.uid,commenterHandle:fn.handle,storyTitle:d.storyTitle,storySlug:d.doc,text:S,reply:!0})})];case 4:return[4,e.sent().json()];case 5:return"ok"===e.sent().status&&console.log("email sent!"),[3,7];case 6:return l=e.sent(),console.log("something went wrong",l),[3,7];case 7:return u={text:S,time:new Date,author:{name:fn.displayName,handle:fn.handle,avatar:fn.avatar,uid:fn.uid,email:fn.email},approved:null,storyTitle:d.storyTitle,doc:d.doc,id:(1e32*Math.random()).toString(36),replies:[],replyingTo:d.author.uid},(p=D).push(u),B(p),k(!1),[4,fetch("https://api.hackernoon.com/comments/addReply",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({par:d.id,comment:u,user:fn.uid,slug:d.doc})})];case 8:return e.sent(),[3,10];case 9:alert("type something longer please"),e.label=10;case 10:return[2]}}))})),yn.apply(this,arguments)}function xn(n,e){return bn.apply(this,arguments)}function bn(){return bn=(0,o.Z)((function(n,e){var t,o,i,c;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return e?"Approved":"Denied",p((0,a.Z)((0,r.Z)({},n),{approved:e})),[4,(0,b.default)()];case 1:return t=s.sent(),(o=t.auth().currentUser)?[4,o.getIdToken()]:(alert("You must be logged in to approve comments"),[2]);case 2:return i=s.sent(),c="Bearer ".concat(i),[4,fetch("https://api.hackernoon.com/comments/approveComment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:c},body:JSON.stringify({comment:n,bool:e,user:fn})})];case 3:return s.sent(),[2]}}))})),bn.apply(this,arguments)}function wn(){return wn=(0,o.Z)((function(n){var e;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return e=n.comment,[4,fetch("https://api.hackernoon.com/comments/removeComment",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:e})})];case 1:return t.sent(),_("removed"),[2]}}))})),wn.apply(this,arguments)}function kn(n,e,t){return jn.apply(this,arguments)}function jn(){return jn=(0,o.Z)((function(n,e,t){var o,r,a,i,l,u;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return fn&&fn.uid&&fn.handle?[3,1]:(window.open("/signup?redirect=".concat(location.pathname,"&action=6"),"_self"),[3,3]);case 1:return o={upvotes:P,downvotes:R,reactions:L},"upvote"===e?(r=(0,c.Z)(P),a=(0,c.Z)(R),r.includes(fn.uid)?r.pop():r.push(fn.uid),a.includes(fn.uid)&&a.pop(),z(r),q(a),o.upvotes=r,o.downvotes=a):"downvote"===e?(i=(0,c.Z)(R),l=(0,c.Z)(P),i.includes(fn.uid)?i.pop():i.push(fn.uid),l.includes(fn.uid)&&l.pop(),q(i),z(l),o.upvotes=l,o.downvotes=i):((u=(0,c.Z)(L))[t].reactedBy.includes(fn.uid)?u[t].reactedBy.length<=1?u[t].reactedBy=[]:u[t].reactedBy.splice(u[t].reactedBy.indexOf(fn.uid),1):u[t].reactedBy.push(fn.uid),J(u),o.reactions[t].reactedBy=u[t].reactedBy),[4,fetch("https://api.hackernoon.com/comments/react",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:n.id,user:fn.uid,doc:n.doc,reactions:o})})];case 2:s.sent(),s.label=3;case 3:return[2]}}))})),jn.apply(this,arguments)}return(0,u.useEffect)((function(){B(d.replies.filter((function(n){return n.approved})))}),[]),(0,u.useEffect)((function(){var n=(0,c.Z)(P),e=(0,c.Z)(R),t=(0,c.Z)(L);d.reactionsDoc&&(n=d.reactionsDoc.reactions.upvotes,z(n),e=d.reactionsDoc.reactions.downvotes,q(e),t.forEach((function(n,e){t[e]=d.reactionsDoc.reactions.reactions[e]})),J(t))}),[d]),(0,l.jsxs)(Q,{onClick:function(){return on(!1)},id:d.id,children:[(0,l.jsx)($,{children:L.map((function(n,e){var t,o;return(null===(t=n.reactedBy)||void 0===t?void 0:t.length)?(0,l.jsxs)("div",{onClick:function(){kn(d,"emojis",e)},className:"emoji",children:[(0,l.jsx)("img",{src:(0,I.Z)("https://cdn.hackernoon.com/images/".concat(n.url)),width:20,height:20})," \xa0"," ",null===(o=n.reactedBy)||void 0===o?void 0:o.length]},e):""}))}),(0,l.jsxs)("div",{className:"profile",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{width:"50px",height:"50px",position:"relative"},children:(0,l.jsx)(x(),{src:d.author.avatar,width:"50px",height:"50px",layout:"fill",objectFit:"cover",style:{borderRadius:"25px"}})}),(0,l.jsxs)(f.Z,{href:"https://hackernoon.com/u/".concat(d.author.handle),style:{marginLeft:"1em",color:"rgb(60, 60, 59)"},children:["@",d.author.handle]})]}),(0,l.jsxs)("span",{className:"date",children:[mn[0],(0,l.jsx)("br",{}),mn[1]]})]}),(0,l.jsx)(H,{defaultValue:pn,value:A||pn,readOnly:!0,dark:gn,theme:{background:"#F6F7F9"},style:{margin:"20px 0",color:"rgb(60, 60, 59)"}}),(0,l.jsxs)(W,{onClick:function(n){return n.stopPropagation()},style:{visibility:tn?"":"hidden"},children:[(0,l.jsx)("div",{className:"emojis-container",children:L.map((function(n,e){var t;return(0,l.jsx)("img",{style:{border:(null===(t=n.reactedBy)||void 0===t?void 0:t.includes(fn.uid))?"1px solid black":"none"},onClick:function(){kn(d,"emojis",e)},src:(0,I.Z)("https://cdn.hackernoon.com/images/".concat(n.url)),width:30,height:30},e)}))}),(0,l.jsx)(K,{})]}),null==d.approved?fn.uid==d.author.uid?(0,l.jsx)("p",{style:{color:"green"},children:"Awaiting Approval"}):(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsx)(V,{onClick:function(){return xn(d,!0)},children:"Approve"}),(0,l.jsx)(V,{onClick:function(){return xn(d,!1)},children:"Deny"})]}):(0,l.jsxs)("p",{style:{display:"flex",margin:0},children:["comment"===d.type?(0,l.jsx)(V,{onClick:function(n){n.stopPropagation(),on(!tn)},children:"\ud83d\ude0a+"}):"",fn.uid?(0,l.jsx)(V,{onClick:function(){return k(!y)},children:null===t||void 0===t?void 0:t.commentReply}):null,(0,l.jsx)(V,{onClick:function(){return function(n){navigator.clipboard.writeText("https://hackernoon.com/".concat(n.doc,"?c=").concat(n.id))}(d)},children:"Share"}),fn.isEditor?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(V,{onClick:function(){return function(n){return wn.apply(this,arguments)}({comment:d})},children:"Remove"}),(0,l.jsx)(V,{onClick:function(){return cn(!an)},children:"Edit"})]}):null]}),y?(0,l.jsxs)(en,{onSubmit:function(n){return function(n,e){return yn.apply(this,arguments)}(n)},children:[(0,l.jsx)(H,{dark:gn,style:{marginTop:"1em",padding:"2em",borderTop:"1px solid #e5e5e5",color:"rgb(60, 60, 59)"},theme:{background:"#F6F7F9",placeholder:"#B1BECC"},placeholder:"Reply to this comment...",maxLength:1400,onChange:function(n){Z(n)},uploadImage:function(){var n=(0,o.Z)((function(n){return(0,s.__generator)(this,(function(e){return[2,(0,w.Z)(n)]}))}));return function(e){return n.apply(this,arguments)}}(),uploaders:fn.isEditor?[E,U]:[]}),(0,l.jsx)("input",{type:"submit",className:"nice-button",value:"Reply"})]}):null,an?(0,l.jsxs)(en,{onSubmit:function(n){return function(n){return vn.apply(this,arguments)}(n)},children:[(0,l.jsx)(H,{dark:gn,style:{padding:"2em"},placeholder:"Share your thoughts...",value:d.text,maxLength:1400,onChange:function(n){un(n)}}),(0,l.jsx)("input",{type:"submit",className:"nice-button",value:"Confirm Edits"})]}):null,D.length>0&&(0,l.jsxs)("div",{className:"replies",children:[(0,l.jsx)("img",{src:"https://cdn.hackernoon.com/turn-down.png"}),(0,l.jsx)("div",{style:{flex:1},children:D.map((function(n){return(0,l.jsx)(nn,{comment:n,staticData:t},n.id)}))})]}),"reply"===d.type?"":(0,l.jsxs)(Y,{hasReplies:D.length>0,children:[(0,l.jsx)(O.Kh,{onClick:function(){kn(d,"upvote",null)},style:{fill:P.includes(fn.uid)?"green":gn?"white":"darkgray"}}),P.length-R.length,(0,l.jsx)(O._M,{onClick:function(){kn(d,"downvote",null)},style:{fill:R.includes(fn.uid)?"green":gn?"white":"darkgray"}})]})]})}var en=h.default.form.withConfig({componentId:"sc-586b8d05-7"})(J(),(function(n){return n.theme.green}));function tn(n){var e,t,r=n.pageData,a=n.query,i=n.quoteToComment,c=(0,v.Z)(!1).value,d=(0,u.useState)(null),p=d[0],h=d[1],y=(0,u.useState)(1),x=y[0],k=y[1],j=(0,u.useState)([]),S=j[0],Z=j[1],C=(0,u.useContext)(m.St).user;function A(){return(A=(0,o.Z)((function(n){var e,t,o,a,i,c,l,u;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return n.preventDefault(),C.handle&&C.uid||(localStorage.setItem("signupComment",p),window.open("/signup?redirect=".concat(location.pathname,"&action=3"),"_self")),p&&p.length>5&&C?((0,F.logEventAPI)({category:"Comments",action:"Added Comment",label:"".concat(C.handle," commented on https://hackernoon.com/").concat(r.slug)}),(0,g.h)("".concat(C.handle," just commented on your story, \u201c").concat(null===r||void 0===r?void 0:r.title,"\u201d. Run - don\u2019t walk - to review it!\ud83c\udfc3\u200d\u2640\ufe0f"),"https://app.hackernoon.com/writer/comments",r.owner),[4,(0,b.default)()]):[3,9];case 1:return e=s.sent(),(t=e.auth().currentUser)?[4,t.getIdToken()]:[2];case 2:o=s.sent(),a={"Content-Type":"application/json",Authorization:"Bearer ".concat(o)},i="https://us-central1-hackernoon-app.cloudfunctions.net/email/send-comment-email",s.label=3;case 3:return s.trys.push([3,6,,7]),[4,fetch(i,{method:"POST",headers:a,body:JSON.stringify({owner:r.owner,commenterHandle:C.handle,storyTitle:r.title,storySlug:r.slug,text:p,reply:!1})})];case 4:return[4,s.sent().json()];case 5:return"ok"===s.sent().status&&console.log("email sent!"),[3,7];case 6:return c=s.sent(),console.log("something went wrong",c),[3,7];case 7:return l={text:p,time:new Date,author:{name:C.displayName,handle:C.handle,avatar:C.avatar,uid:C.uid,email:C.email},storyTitle:r.title,approved:r.allowAllComments?r.allowAllComments:!!C.isEditor||null,doc:r.slug,id:(1e32*Math.random()).toString(36),replyingTo:r.owner||"Archived",replies:[]},(u=S).unshift(l),Z(u),h(null),k(x+1),[4,fetch("https://api.hackernoon.com/comments/addComment",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment:l,user:C.uid,data:r})})];case 8:return s.sent(),[3,10];case 9:alert("Type something longer please"),s.label=10;case 10:return[2]}}))}))).apply(this,arguments)}return(0,u.useEffect)((function(){i.length>0&&h("> ".concat(i))}),[i]),(0,u.useEffect)((function(){var n=document.getElementById(a);n&&n.scrollIntoView()}),[S,a]),(0,u.useEffect)((function(){function e(){return(e=(0,o.Z)((function(){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,fetch("https://api.hackernoon.com/comments/getComments",{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:r.slug})}).then((function(n){return n.json()})).then((function(n){C.isEditor?Z(n.comments.sort((function(n,e){return(e.reactionsDoc?e.reactionsDoc.reactions.upvotes.length-e.reactionsDoc.reactions.downvotes.length:0)-(n.reactionsDoc?n.reactionsDoc.reactions.upvotes.length-n.reactionsDoc.reactions.downvotes.length:0)}))):Z(n.comments.filter((function(n){return n.approved})).sort((function(n,e){return(e.reactionsDoc?e.reactionsDoc.reactions.upvotes.length-e.reactionsDoc.reactions.downvotes.length:0)-(n.reactionsDoc?n.reactionsDoc.reactions.upvotes.length-n.reactionsDoc.reactions.downvotes.length:0)})))}))];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}!function(){e.apply(this,arguments)}();var t=new URLSearchParams(window.location.search),a=new URLSearchParams(t).get("action"),i=localStorage.getItem("signupComment");"3"===a&&(n.setQuoteToComment(i),localStorage.removeItem("signupComment"))}),[]),(0,l.jsxs)(X,{children:[(0,l.jsx)("h4",{children:null===r||void 0===r||null===(e=r.staticData)||void 0===e?void 0:e.comments}),C.isCommentCursed?(0,l.jsxs)("p",{style:{textAlign:"center"},children:["You lost commenting rights for breaching HackerNoon"," ",(0,l.jsx)(f.Z,{target:"_blank",href:"/help/ede3d241-5b93-4ffb-8c65-365a8b5c89d6",children:"comment policy"}),"!"]}):(0,l.jsxs)(en,{onSubmit:function(n){return function(n){return A.apply(this,arguments)}(n)},children:[(0,l.jsx)(H,{dark:c,style:{paddingBottom:"1em"},placeholder:"Share your thoughts...",maxLength:1400,value:i,onChange:function(n){h(n)},uploadImage:function(){var n=(0,o.Z)((function(n){return(0,s.__generator)(this,(function(e){return[2,(0,w.Z)(n)]}))}));return function(e){return n.apply(this,arguments)}}(),uploaders:C.isEditor?[E,U]:[]},x),(0,l.jsx)("input",{type:"submit",className:"nice-button",value:null===r||void 0===r||null===(t=r.staticData)||void 0===t?void 0:t.addComment})]}),S.map((function(n){return(0,l.jsx)(nn,{comment:n,id:n.id,staticData:null===r||void 0===r?void 0:r.staticData},n.id)}))]})}},17269:function(n,e,t){var o=t(7297);function r(){var n=(0,o.Z)(["\n  padding: 2px 0 1px 0;\n  cursor: pointer;\n  background-image: linear-gradient(\n    transparent 0%,\n    transparent calc(50% - 9px),\n    rgba(0, 255, 0, 0.35) calc(50% - 9px),\n    rgba(0, 255, 0, 0.35) 100%\n  );\n  transition: all 120ms ease-in-out;\n  background-size: 100% 200%;\n  background-position: 0 0;\n  word-break: break-word;\n\n  &:hover {\n    background-image: linear-gradient(\n      transparent 0%,\n      transparent calc(50% - 9px),\n      "," calc(50% - 9px),\n      "," 100%\n    );\n    background-position: 0 100%;\n  }\n\n  &:focus {\n    text-shadow: 1px 1px 0 ",";\n  }\n"]);return r=function(){return n},n}var a=t(27603).default.a.withConfig({componentId:"sc-3953247f-0"})(r(),(function(n){var e=n.theme;return e.darkMode?e.darkGreen:e.green}),(function(n){var e=n.theme;return e.darkMode?e.darkGreen:e.green}),(function(n){var e=n.theme;return e.darkMode?e.veryDarkGreen:e.darkGreen}));e.Z=a},29494:function(n,e,t){t.d(e,{Z:function(){return p}});var o=t(47568),r=t(20414),a=t(81923),i=t.n(a),c=(t(33404),t(62830)),s=t.n(c),l=t(80983),u=t(9669),d=t.n(u);function p(n,e,t){return new Promise((function(a,c){var u="image/gif"==n.type,p="".concat(t,"-").concat(s().slug(),".").concat(l.extension(n.type)),h=i().storage().ref("images").child(p).put(n);h.on("state_changed",(function(n){var t=n.bytesTransferred/n.totalBytes*100;e&&e(t)}),(function(n){return console.log("Got error",n),c(new Error("unable_to_upload"))}),(function(){h.snapshot.ref.getDownloadURL().then(function(){var n=(0,o.Z)((function(n){var e,t,i,c,s,l,p,h,m;return(0,r.__generator)(this,(function(f){switch(f.label){case 0:return e=new URL(n),t=e.pathname.split("/"),i=t.pop(),c="/"+decodeURIComponent(i.split("?")[0]),"https://cdn.hackernoon.com",s="".concat("https://cdn.hackernoon.com").concat(c).concat(u?".webp":""),u?(l=0,80,p=function(){var n=(0,o.Z)((function(n,e,t){var o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,n()];case 1:o=r.sent(),r.label=2;case 2:return e(o)?[4,h(t)]:[3,5];case 3:return r.sent(),[4,n()];case 4:return o=r.sent(),[3,2];case 5:return[2,o]}}))}));return function(e,t,o){return n.apply(this,arguments)}}(),h=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(e){setTimeout(e,n)}))},m=function(){var n=(0,o.Z)((function(){return(0,r.__generator)(this,(function(n){return l+=1,[2,d().head(s).catch((function(n){console.log(n)}))]}))}));return function(){return n.apply(this,arguments)}}(),[4,p(m,(function(n){return!(l>80)&&200!==(null===n||void 0===n?void 0:n.status)}),700)]):[3,2];case 1:f.sent(),f.label=2;case 2:return a(s),[2]}}))}));return function(e){return n.apply(this,arguments)}}()).catch((function(n){console.error(n),c(new Error("unable_to_upload"))}))}))}))}}}]);